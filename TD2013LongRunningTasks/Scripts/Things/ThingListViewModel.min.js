var Things;(function(n){var t=function(){function t(){var t=this,i,r;this.thingList=ko.observable(),this.loaded=ko.observable(!1),this.error=$.Topic("message/error"),this.warning=$.Topic("message/warning"),this.info=$.Topic("message/info"),this.hub=$.connection.tasks,i=new JSBus.SignalRSendTransport(this.hub.server),r=new JSBus.SignalRSubscribeTransport(this.hub.client),this.bus=new JSBus.Bus("tasks",i,r),this.bus.subscribe(function(i){t.thingList().replace(new n.Thing(i.AffectedTask))},"TaskUpdated"),$.connection.hub.start(function(){t.hub.server.getTasks().then(function(i){t.thingList(new n.ThingList(i)),t.loaded(!0)}).fail(function(){t.error.publish("Error retrieving data from server")})})}return t.prototype.longOperation=function(){var t=this,n=this.thingList().CheckedItems();n.forEach(function(n){n.OperationPending(!0),n.IsChecked(!1),t.bus.send({name:"StartTask",id:n.Id})}),this.info.publish("Processing "+n.length+" items...")},t}();n.ThingListViewModel=t,t.instance=new t,t.instance.loaded.subscribe(function(){ko.applyBindings(t.instance,document.getElementById("mytasks-layout"))})})(Things||(Things={}))